
# {{ .Emoji "whale" }}Docker Image Analysis: {{ .ImageTag }}

{{- if .Stats }}
![Size]({{ .Stats.SizeBadge $.Options.BadgeBaseURL }}) ![Layers]({{ .Stats.LayersBadge $.Options.BadgeBaseURL }}) ![Vulns]({{ .Stats.VulnBadge $.Options.BadgeBaseURL }}) ![Efficiency]({{ .Stats.EfficiencyBadge $.Options.BadgeBaseURL }})
{{- end }}

## {{ .Emoji "gear" }}Configuration

{{- if (len (.Doc.FilterByType "ENV")) }}

### Environment Variables

| Name | Description | Default | Required |
|------|-------------|---------|:--------:|
{{- range (.Doc.FilterByType "ENV") }}
| `{{ .Name }}` | {{ .Description }} | `{{ if .Value }}{{ .Value }}{{ else }}""{{ end }}` | {{ if .Required }}{{ $.Emoji "check" }}{{ else }}{{ $.Emoji "cross" }}{{ end }} |
{{- end }}
{{- end }}

{{- if (len (.Doc.FilterByType "ARG")) }}

### Build Arguments

| Name | Description | Default | Required |
|------|-------------|---------|:--------:|
{{- range (.Doc.FilterByType "ARG") }}
| `{{ .Name }}` | {{ .Description }} | `{{ .Value }}` | {{ if .Required }}{{ $.Emoji "check" }}{{ else }}{{ $.Emoji "cross" }}{{ end }} |
{{- end }}
{{- end }}

{{- if (len (.Doc.FilterByType "EXPOSE")) }}

### Exposed Ports

| Port | Description |
|------|-------------|
{{- range (.Doc.FilterByType "EXPOSE") }}
| `{{ .Name }}` | {{ .Description }} |
{{- end }}
{{- end }}

{{- if (len (.Doc.FilterByType "LABEL")) }}

### Labels

| Key | Value |
|-----|-------|
{{- range (.Doc.FilterByType "LABEL") }}
| `{{ .Name }}` | {{ .Value }} |
{{- end }}
{{- end }}

{{- if .Stats }}

---

## {{ .Emoji "shield" }}Security & Efficiency

### Image Metadata

| Property | Value |
|----------|-------|
| **Tag** | `{{ .Stats.ImageTag }}` |
| **Base Image OS** | `{{ if .Stats.OSDistro }}{{ .Stats.OSDistro }}{{ else }}{{ .Stats.OS }}{{ end }}` |
| **Architecture** | `{{ .Stats.Architecture }}` |
| **OS** | `{{ .Stats.OS }}` |
{{- if .Stats.SupportedArchitectures }}
| **Supported Architectures** | `{{ join .Stats.SupportedArchitectures ", " }}` |
{{- end }}
| **Image Size** | {{ .Stats.SizeMB }} |
| **Total Layers** | {{ .Stats.TotalLayers }} |
| **Efficiency Score** | {{ printf "%.1f" .Stats.Efficiency }}% |
| **Wasted Space** | {{ .Stats.WastedMB }} |

### Vulnerability Summary
{{- if not .Stats.VulnScanTime.IsZero }}

**Last scanned:** {{ .Stats.VulnScanTime.Format "2006-01-02T15:04:05Z07:00" }}
{{- end }}

| Critical | High | Medium | Low | Total |
|:---:|:---:|:---:|:---:|:---:|
| {{ if gt (index .Stats.VulnSummary "Critical") 0 }}{{ .Emoji "critical" }} {{ else }}{{ .Emoji "clean" }} {{ end }}{{ index .Stats.VulnSummary "Critical" }} | {{ if gt (index .Stats.VulnSummary "High") 0 }}{{ .Emoji "high" }} {{ else }}{{ .Emoji "clean" }} {{ end }}{{ index .Stats.VulnSummary "High" }} | {{ if gt (index .Stats.VulnSummary "Medium") 0 }}{{ .Emoji "medium" }} {{ else }}{{ .Emoji "clean" }} {{ end }}{{ index .Stats.VulnSummary "Medium" }} | {{ if gt (index .Stats.VulnSummary "Low") 0 }}{{ .Emoji "low" }} {{ else }}{{ .Emoji "clean" }} {{ end }}{{ index .Stats.VulnSummary "Low" }} | {{ .Stats.TotalVulns }} |

### Vulnerability Details

| ID | Severity | Package | Version |
|----|----------|---------|---------|
{{- range .Stats.Vulnerabilities }}
| [{{ .ID }}](https://nvd.nist.gov/vuln/detail/{{ .ID }}) | {{ .Severity }} | `{{ .Package }}` | `{{ .Version }}` |
{{- end }}
{{- if not .Stats.Vulnerabilities }}
| - | - | No vulnerabilities found | - |
{{- end }}

### Installed Packages ({{ .Stats.TotalPackages }} total)

| Package | Version |
|---------|---------|
{{- range .Stats.Packages }}
| {{ .Name }} | {{ .Version }} |
{{- end }}
{{- if not .Stats.Packages }}
| - | No packages found |
{{- end }}
{{- end }}
